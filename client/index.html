<center>
	=== dotGame ===
	<br>
	<table>
		<tbody>
			<tr>
				<td>
					<canvas id="ctx" width="1000" height="600" style="border:1px solid #000000;"></canvas>
				</td>
				<td>
					<div id="players-div" style="height:600px;width:200px; border:1px solid #000000;"></div>
				</td>
			</tr>
		</tbody>
	</table>
	
</center>

<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
<script>
	var WIDTH = 1000;
	var HEIGHT = 600;
	var ctx = document.getElementById("ctx").getContext("2d");
	ctx.font = '30px Arial';
	var playersDiv = document.getElementById("players-div");

	var socket = io();
	
	window.onbeforeunload = function() {
		socket.disconnect(); 
	}
	
	socket.on('updatePack',function(data){
		ctx.clearRect(0,0,WIDTH,HEIGHT);
		playersDiv.innerHTML = "Players:";
		// players
		for(var i = 0; i < data.pack.length; i++) {
			ctx.fillStyle = data.pack[i].color;
			ctx.fillText(data.pack[i].number, data.pack[i].x, data.pack[i].y);
			playersDiv.innerHTML += '<div style="color:'+ data.pack[i].color +'">' + data.pack[i].id + '</div>';
		}
		// factories
		ctx.strokeStyle = 'red';
		for(var i = 0; i < data.factories.length; i++) {
			ctx.beginPath();
			ctx.arc(data.factories[i].x,data.factories[i].y,10,0,2*Math.PI);
			ctx.stroke();
		}
	});
	
	document.onkeydown = function(event){
		if(event.keyCode === 68) // d
			socket.emit('keyPress',{inputId:'right',state:true});
		else if(event.keyCode === 83) // s
			socket.emit('keyPress',{inputId:'down',state:true});
		else if(event.keyCode === 65) // a
			socket.emit('keyPress',{inputId:'left',state:true});
		else if(event.keyCode === 87) // w
			socket.emit('keyPress',{inputId:'up',state:true});
	}
	document.onkeyup = function(event){
		if(event.keyCode === 68) // d
			socket.emit('keyPress',{inputId:'right',state:false});
		else if(event.keyCode === 83) // s
			socket.emit('keyPress',{inputId:'down',state:false});
		else if(event.keyCode === 65) // a
			socket.emit('keyPress',{inputId:'left',state:false});
		else if(event.keyCode === 87) // w
			socket.emit('keyPress',{inputId:'up',state:false});
	}
</script>